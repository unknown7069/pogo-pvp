<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Battle</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* Battle page styles (scoped) */
    .battle-screen { display: grid; grid-template-rows: auto auto 1fr auto; height: 100%; }
    .battle-screen *, .battle-screen *::before, .battle-screen *::after { box-sizing: border-box; }

    /* Sky/ground backdrop like classic games */
    .battle-stage {
      position: relative;
      background: linear-gradient(#b7e0ff 55%, #8adf8a 55%);
      overflow: hidden;
    }

    /* Top status bar: opponent (left) and player (right) */
    .battle-forfeit { display:flex; align-items:center; padding: 6px 8px; background:#fff; border-bottom:1px solid #e5e5e5; }
    .forfeit-btn { font-size: 12px; padding: 6px 10px; border-radius: 999px; border: 1px solid #d0d0d0; background:#f2f2f7; color:#111; font-weight:700; cursor:pointer; }
    .forfeit-btn:active { transform: translateY(1px); }
    .battle-topbar { display: flex; justify-content: space-between; padding: 10px 12px; gap: 10px; background:#fff; border-bottom:1px solid #e5e5e5; flex-wrap: nowrap; align-items: center; }
    .trainer-side { display: flex; align-items: center; gap: 8px; min-width: 0; flex: 1 1 0; }
    .trainer-side.player { order: 1; justify-content: flex-start; }
    .trainer-side.opponent { order: 2; justify-content: flex-end; }

    .hp-card { background:#fff; border: 2px solid #222; border-radius: 8px; padding: 8px 10px; width: 100%; max-width: 260px; min-width: 0; box-shadow: 0 2px 0 rgba(0,0,0,0.15); }
    .hp-name-row { display:flex; justify-content:space-between; align-items:baseline; margin-bottom:6px; font-weight:700; }
    .hp-bar-wrap { position:relative; height:10px; background:#e9e9e9; border:1px solid #111; border-radius:6px; overflow:hidden; }
    .hp-bar { position:absolute; inset:0 auto 0 0; width:var(--hp,100%); background:linear-gradient(90deg,#2ecc71,#27ae60); transition: width 200ms ease, background 150ms; }
    .hp-count { font-size:12px; opacity:0.8; margin-top:4px; display:flex; justify-content:space-between; align-items:center; }
    .pokemon-orbs { display:flex; gap:4px; margin-left:6px; }
    .pokemon-orbs .orb { width:10px; height:10px; border-radius:50%; background:#ddd; border:1px solid #333; }
    .pokemon-orbs .orb.active { background:#4caf50; }

    /* Sprites and platforms in the middle stage */
    .sprite { position:absolute; width:min(42%, 240px); height:min(42%, 240px); display:flex; align-items:center; justify-content:center; font-weight:800; color:#222; border-radius:50%;
      background: radial-gradient(circle at 35% 35%, #ffffff, #d9ecff); border: 4px solid rgba(255,255,255,0.85); box-shadow: 0 10px 28px rgba(0,0,0,0.15); }
    .sprite.opponent { right: 6%; top: 6%; transform: scaleX(-1); }
    .sprite.player { left: 6%; bottom: 10%; }

    .platform { position:absolute; width:38%; height:20%; background: radial-gradient(ellipse at center, rgba(0,0,0,0.22), rgba(0,0,0,0)); pointer-events:none; }
    .platform.opponent { right: 3%; top: 22%; }
    .platform.player { left: 3%; bottom: 12%; }

    /* Bottom action area with three circular moves */
    .battle-actions { background:#fff; border-top:1px solid #e5e5e5; padding:12px 16px 16px; display:grid; grid-template-columns:repeat(3, 1fr); gap:14px; align-items: start; }
    .move { display:flex; flex-direction:column-reverse; align-items:center; justify-content:flex-start; gap:6px; min-width:0; }
    .move-btn { width: clamp(56px, 10vw + 28px, 84px); height: clamp(56px, 10vw + 28px, 84px); border-radius: 999px; background:#ffffff; border:2px solid #222; cursor:pointer; user-select:none; transition: transform 80ms ease, background 120ms ease; display:block; }
    .move-btn:hover { background:#f0f8ff; }
    .move-btn:active { transform: translateY(1px); }
    .move-label { font-size: 12px; font-weight: 700; text-align: center; color: #111; max-width: 100%; }

    @media (max-width: 720px) {
      .sprite { width:min(50%, 220px); height:min(50%, 220px); }
    }

    @media (max-width: 380px) {
      .battle-topbar { padding: 8px; gap: 8px; }
      .hp-count { font-size: 11px; }
    }

    /* Overlay confirm dialog */
    .confirm-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.35); display: none; align-items: center; justify-content: center; z-index: 10; padding: 20px; }
    .confirm-overlay.show { display: flex; }
    .confirm-card { width: 100%; max-width: 360px; background: #fff; border-radius: 12px; border: 1px solid #d0d0d0; box-shadow: 0 10px 24px rgba(0,0,0,0.15); overflow: hidden; }
    .confirm-body { padding: 16px; font-weight: 700; text-align: center; }
    .confirm-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 12px; border-top: 1px solid #eee; background: #fafafa; }
    .btn-danger { background: #ff3b30; color: #fff; border: 1px solid transparent; }

    /* Countdown overlay (blocks interaction for 3s) */
    .countdown-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.35); display: none; align-items: center; justify-content: center; z-index: 20; }
    .countdown-overlay.show { display: flex; }
    .countdown-number { color: #fff; font-weight: 900; font-size: clamp(48px, 12vw, 96px); text-shadow: 0 6px 18px rgba(0,0,0,0.5); }
    .countdown-number.pop { animation: cd-pop 400ms ease both; }
    @keyframes cd-pop { from { transform: scale(0.6); opacity: 0.4; } to { transform: scale(1); opacity: 1; } }

    /* Disabled state visuals */
    .move-btn:disabled, .forfeit-btn:disabled { opacity: 0.6; cursor: not-allowed; }
  </style>
</head>
<body>
  <div class="phone phone-column">
    <main class="battle-screen" role="main">
      <!-- Top bars -->
      <section class="battle-forfeit">
        <button class="forfeit-btn" id="forfeitBtn" type="button">Forfeit</button>
      </section>

      <section class="battle-topbar">
        <div class="trainer-side opponent">
          <div class="hp-card">
            <!-- name/level removed by request -->
            <div class="hp-bar-wrap" aria-label="Opponent HP">
              <div class="hp-bar" id="opponent-hp" style="--hp: 80%"></div>
            </div>
            <div class="hp-count">
              <span><span id="opponent-hp-text">80/100</span></span>
              <span class="pokemon-orbs" aria-label="Opponent remaining Pokemon">
                <span class="orb active"></span>
                <span class="orb active"></span>
                <span class="orb active"></span>
              </span>
            </div>
          </div>
        </div>

        <div class="trainer-side player">
          <div class="hp-card">
            <!-- name/level removed by request -->
            <div class="hp-bar-wrap" aria-label="Player HP">
              <div class="hp-bar" id="player-hp" style="--hp: 100%"></div>
            </div>
            <div class="hp-count">
              <span><span id="player-hp-text">100/100</span></span>
              <span class="pokemon-orbs" aria-label="Your remaining Pokemon">
                <span class="orb active"></span>
                <span class="orb active"></span>
                <span class="orb active"></span>
              </span>
            </div>
          </div>
        </div>
      </section>

      <!-- Stage area -->
      <section class="battle-stage" role="img" aria-label="Battle stage">
        <div class="platform opponent"></div>
        <div class="sprite opponent" aria-label="Opponent Pokemon">OPP</div>
        <div class="platform player"></div>
        <div class="sprite player" aria-label="Your Pokemon">YOU</div>
      </section>

      <!-- Actions -->
      <section class="battle-actions" aria-label="Battle actions">
        <div class="move">
          <button class="move-btn" data-move="move1" aria-label="Move 1"></button>
          <div class="move-label">Move 1</div>
        </div>
        <div class="move">
          <button class="move-btn" data-move="move2" aria-label="Move 2"></button>
          <div class="move-label">Move 2</div>
        </div>
        <div class="move">
          <button class="move-btn" data-move="move3" aria-label="Move 3"></button>
          <div class="move-label">Move 3</div>
        </div>
      </section>

      <!-- Overlay confirmation dialog for forfeiting -->
      <div class="confirm-overlay" id="forfeitOverlay" role="dialog" aria-modal="true" aria-labelledby="forfeitTitle">
        <div class="confirm-card">
          <div class="confirm-body" id="forfeitTitle">Are you sure you want to forfeit?</div>
          <div class="confirm-actions">
            <button class="btn btn-secondary" id="cancelForfeit" type="button">Cancel</button>
            <button class="btn btn-danger" id="confirmForfeit" type="button">Forfeit</button>
          </div>
        </div>
      </div>

      <!-- 3-second countdown overlay -->
      <div class="countdown-overlay" id="countdownOverlay" aria-hidden="true">
        <div class="countdown-number" id="countdownText">3</div>
      </div>
    </main>
  </div>

  <script src="shared.js"></script>
  <script src="battle.js"></script>
</body>
</html>
